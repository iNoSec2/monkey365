{
  "args": [
    
  ],
  "provider": "Azure",
  "serviceType": "PostgreSQL Configuration",
  "serviceName": "Database Configuration",
  "displayName": "Ensure server parameter 'log_connections' is set to 'ON' for PostgreSQL single server",
  "description": "Enable `log_connections` on `PostgreSQL single servers`.",
  "rationale": "Enabling log_connections helps PostgreSQL Database to log attempted connection to the server, as well as successful completion of client authentication. Log data can be used to identify, troubleshoot, and repair configuration errors and suboptimal performance.",
  "impact": null,
  "remediation": {
    "text": null,
    "code": {
      "powerShell": null,
      "iac": null,
      "terraform": null,
      "other": null
    }
  },
  "recommendation": null,
  "references": [
    "https://docs.microsoft.com/en-us/rest/api/postgresql/configurations/listbyserver"
  ],
  "compliance": [
    {
      "name": "CIS Microsoft Azure Foundations",
      "version": "3.0.0",
      "reference": "5.2.6",
	  "profile": "Level 1"
    }
  ],
  "level": "medium",
  "tags": [
	"legacy"
  ],
  "rule": {
    "path": "az_postgresql_servers",
    "subPath": null,
    "selectCondition": {
      
    },
    "query": [
      {
        "filter": [
          {
            "conditions": [
              [
                "parameterName",
                "eq",
                "log_connections"
              ],
              [
                "parameterValue",
                "ne",
                "on"
              ]
            ],
            "operator": "and",
            "whereObject": "configuration"
          }
        ]
      }
    ],
    "shouldExist": null,
    "returnObject": null,
    "removeIfNotExists": null
  },
  "output": {
    "html": {
      "data": {
		"properties": {
          "Name": "Server Name",
          "Location": "Parameter",
          "resourceGroupName": "Resource Group Name"
        },
        "expandObject": null
      },
      "table": "Normal",
      "decorate": [
        
      ],
      "emphasis": [
      ],
      "actions": {
        "objectData": {
          "properties": [
            "configuration"
          ],
          "expandObject": null,
          "limit": null
        },
        "showGoToButton": "true",
        "showModalButton": "true",
        "directLink": null
      }
    },
    "text": {
      "data": {
        "properties": {
          
        },
        "expandObject": null
      },
      "status": {
        "keyName": [
          
        ],
        "message": "",
        "defaultMessage": null
      },
      "properties": {
        "resourceName": null,
        "resourceId": null,
        "resourceType": null
      },
      "onlyStatus": false
    }
  },
  "idSuffix": "postgresql_log_connections_disabled",
  "notes": [
    
  ],
  "categories": [
    
  ]
}


