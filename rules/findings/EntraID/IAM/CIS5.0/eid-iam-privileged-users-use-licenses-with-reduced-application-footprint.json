{
  "args": [],
  "provider": "Microsoft365",
  "serviceType": "EntraID",
  "serviceName": "Microsoft 365",
  "displayName": "Ensure privileged users use licenses with reduced application footprint",
  "description": "Privileged users (such as global admins) should be assigned licenses that minimize unnecessary application access, reducing the attack surface.",
  "rationale": "Limiting the application footprint for privileged accounts reduces the risk of compromise and lateral movement by attackers.",
  "impact": "Privileged users may have access to fewer applications, which may affect their workflow but increases security.",
  "remediation": {
    "text": "Review licenses assigned to privileged users and assign only those necessary for their administrative tasks. Remove unnecessary application access from these accounts.",
    "code": {"powerShell": null, "iac": null, "terraform": null, "other": null}
  },
  "recommendation": null,
  "references": [
    "https://learn.microsoft.com/en-us/azure/active-directory/roles/security-planning"
  ],
  "compliance": [
    {"name": "CIS Microsoft 365 Foundations", "version": "5.0.0", "reference": "1.1.3"}
  ],
  "level": "medium",
  "tags": ["CIS Microsoft 365 Foundations 5.0.0 1.1.3", "EntraID", "IAM"],
  "rule": {
    "path": "aad_domain_users",
    "subPath": null,
    "selectCondition": "[?privilegedUserHasExcessiveLicenses == 'True']",
    "query": [],
    "shouldExist": null,
    "returnObject": null,
    "removeIfNotExists": null
  },
  "output": {
    "html": {
      "data": {"properties": {"privilegedUserHasExcessiveLicenses": "Privileged User Has Excessive Licenses"}, "expandObject": "value"},
      "table": "Normal",
      "decorate": [{"ItemName": "Privileged User Has Excessive Licenses", "ItemValue": "True", "className": "badge bg-danger larger-badge"}],
      "emphasis": [],
      "actions": {"objectData": {"properties": ["*"], "expandObject": null, "limit": null}, "showGoToButton": "False", "showModalButton": "True", "directLink": null}
    },
    "text": {
      "data": {"properties": {}, "expandObject": null},
      "status": {"keyName": [], "message": "Privileged users have licenses with excessive application access.", "defaultMessage": null},
      "properties": {"resourceName": "PrivilegedUserLicenses", "resourceId": "PrivilegedUser", "resourceType": "Microsoft.Graph.User"},
      "onlyStatus": true
    }
  },
  "idSuffix": "eid-iam-privileged-users-use-licenses-with-reduced-application-footprint",
  "notes": ["This control is equivalent to 1.1.3 in CIS 5.0.0."],
  "categories": []
}