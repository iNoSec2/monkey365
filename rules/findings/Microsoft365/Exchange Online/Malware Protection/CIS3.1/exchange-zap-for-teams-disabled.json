{
  "args": [
    
  ],
  "provider": "Microsoft365",
  "serviceType": "Exchange Online",
  "serviceName": "Microsoft 365",
  "displayName": "Ensure Zero-hour auto purge for Microsoft Teams is on",
  "description": "Zero-hour auto purge (ZAP) is a protection feature that retroactively detects and neutralizes malware and high confidence phishing. When ZAP for Teams protection blocks a message, the message is blocked for everyone in the chat. The initial block happens right after delivery, but ZAP occurs up to 48 hours after delivery.",
  "rationale": "ZAP is intended to protect users that have received zero-day malware messages or content that is weaponized after being delivered to users. It does this by continually monitoring spam and malware signatures taking automated retroactive action on messages that have already been delivered.",
  "impact": "As with any anti-malware or anti-phishing product false positives may occur.",
  "remediation": {
    "text": "
			###### To remediate using the UI: 
			1. Navigate to Microsoft Defender https://security.microsoft.com/ 
			2. Click Settings > Email & collaboration > Microsoft Teams protection. 
			3. Set Zero-hour auto purge (ZAP) to On (Default) 
	",
    "code": {
      "powerShell": null,
      "iac": null,
      "terraform": null,
      "other": null
    }
  },
  "recommendation": null,
  "references": [
		"https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/zero-hour-auto-purge?view=o365-worldwide#zero-hour-auto-purge-zap-in-microsoft-teams",
		"https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/mdo-support-teams-about?view=o365-worldwide#configure-zap-for-teams-protection-in-defender-for-office-365-plan-2"
  ],
  "compliance": [
    {
      "name": "CIS Microsoft 365 Foundations Benchmark",
      "version": "3.1.0",
      "reference": "2.4.4",
	  "profile": "E5 Level 1"
    }
  ],
  "level": "medium",
  "tags": [
    
  ],
  "rule": {
    "path": "",
    "subPath": null,
    "selectCondition": {
      
    },
    "query": [
    ],
    "shouldExist": null,
    "returnObject": null,
    "removeIfNotExists": null
  },
  "output": {
    "html": {
      "data": {
        "properties": {
          
        },
        "expandObject": null
      },
      "table": null,
      "decorate": [
        
      ],
      "emphasis": [
        
      ],
      "actions": {
        "objectData": {
          "properties": [
            "*"
          ],
          "expandObject": null,
          "limit": null
        },
        "showGoToButton": false,
        "showModalButton": false,
        "directLink": null
      }
    },
    "text": {
      "data": {
        "properties": {
          
        },
        "expandObject": null
      },
      "status": {
        "keyName": [
          
        ],
        "message": "Ensure Zero-hour auto purge for Microsoft Teams is on",
        "defaultMessage": null
      },
      "properties": {
        "resourceName": null,
        "resourceId": null,
        "resourceType": null
      },
      "onlyStatus": false
    }
  },
  "idSuffix": "m365_exo_zap_for_teams_not_enabled",
  "notes": [
    
  ],
  "categories": [
    
  ]
}

