{
  "args": [],
  "provider": "Microsoft365",
  "serviceType": "Exchange Online",
  "serviceName": "Microsoft 365",
  "displayName": "Ensure Priority accounts have 'Strict protection' presets applied",
  "description": "Preset security policies have been established by Microsoft, utilizing observations and experiences within datacenters to strike a balance between the exclusion of malicious content from users and limiting unwarranted disruptions. These policies can apply to all, or select users and encompass recommendations for addressing spam, malware, and phishing threats. The policy parameters are pre-determined and non-adjustable.\n\nStrict protection has the most aggressive protection of the 3 presets.\n\n*   EOP: Anti-spam, Anti-malware and Anti-phishing\n*   Defender: Spoof protection, Impersonation protection and Advanced phishing\n*   Defender: Safe Links and Safe Attachments\n\nNOTE: The preset security polices cannot target Priority account TAGS currently, groups should be used instead.",
  "rationale": "Enabling priority account protection for users in Microsoft 365 is necessary to enhance security for accounts with access to sensitive data and high privileges, such as CEOs, CISOs, CFOs, and IT admins. These priority accounts are often targeted by spear phishing or whaling attacks and require stronger protection to prevent account compromise.\n\nThe implementation of stringent, pre-defined policies may result in instances of false positive, however, the benefit of requiring the end-user to preview junk email before accessing their inbox outweighs the potential risk of mistakenly perceiving a malicious email as safe due to its placement in the inbox.",
  "impact": "Strict policies are more likely to cause false positives in anti-spam, phishing, impersonation, spoofing and intelligence responses.",
  "remediation": {
    "text": "To remediate using the UI:\n1. Navigate to Microsoft 365 Defender https://security.microsoft.com/\n2. Select to expand E-mail & collaboration.\n3. Select Policies & rules > Threat policies > Preset security policies.\n4. Click to Manage protection settings for Strict protection preset.\n5. For Apply Exchange Online Protection select at minimum Specific recipients and include the Accounts/Groups identified as Priority Accounts.\n6. For Apply Defender for Office 365 Protection select at minimum Specific recipients and include the Accounts/Groups identified as Priority Accounts.\n7. For Impersonation protection click Next and add valid e-mails or priority accounts both internal and external that may be subject to impersonation.\n8. For Protected custom domains add the organization's domain name, along side other key partners.\n9. Click Next and finally Confirm",
    "code": {
      "powerShell": null,
      "iac": null,
      "terraform": null,
      "other": null
    }
  },
  "recommendation": null,
  "references": [
    "https://learn.microsoft.com/en-us/defender-office-365/preset-securitypolicies?view=o365-worldwide",
    "https://learn.microsoft.com/en-us/defender-office-365/priority-accounts-securityrecommendations",
    "https://learn.microsoft.com/en-us/defender-office-365/recommended-settings-foreop-and-office365?view=o365-worldwide#impersonation-settings-in-antiphishing-policies-in-microsoft-defender-for-office-365"
  ],
  "compliance": [
    {
      "name": "CIS Microsoft 365 Foundations",
      "version": "5.0.0",
      "reference": "8.1.1" 
    }
  ],
  "level": "medium",
  "tags": [
    "CIS Microsoft 365 Foundations 5.0.0 8.1.1",
    "Exchange Online",
    "ATP"
  ],
  "rule": {
    "path": "o365_exo_atp_builtin_protection_rule",
    "subPath": null,
    "selectCondition": "[?value.enabled == 'False']",
    "query": [],
    "shouldExist": null,
    "returnObject": null,
    "removeIfNotExists": null
  },
  "output": {
    "html": {
      "data": {
        "properties": {
          "name": "Rule Name",
          "state": "State",
          "comments": "Comments (Indicates if Standard or Strict)"
        },
        "expandObject": null
      },
      "table": "Normal",
      "decorate": [
        {
          "ItemName": "State",
          "ItemValue": "disabled",
          "className": "badge bg-danger larger-badge"
        }
      ],
      "emphasis": [],
      "actions": {
        "objectData": {
          "properties": ["*"],
          "expandObject": null,
          "limit": null
        },
        "showGoToButton": "True",
        "showModalButton": "True",
        "directLink": null
      }
    },
    "text": {
      "data": {
        "properties": {},
        "expandObject": null
      },
      "status": {
        "keyName": [],
        "message": "ATP Built-In Protection Rules (Preset Security Policies like Standard or Strict) are not enabled.",
        "defaultMessage": null
      },
      "properties": {
        "resourceName": "name",
        "resourceId": "distinguishedName",
        "resourceType": "Microsoft.Exchange.Management.SystemConfigurationTasks.AtpProtectionPolicyRule"
      },
      "onlyStatus": false
    }
  },
  "idSuffix": "exchange-atp-preset-security-policy-not-enabled",
  "notes": [
    "This control is similar to 2.4.2. The CIS benchmark 8.1.1 refers to ATP Preset Security Policies which are checked by the 'o365_exo_atp_builtin_protection_rule' data path."
  ],
  "categories": []
}