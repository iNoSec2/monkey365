{
  "args": [],
  "provider": "Microsoft365",
  "serviceType": "Microsoft Forms",
  "serviceName": "Microsoft 365",
  "displayName": "Ensure internal phishing protection for Forms is enabled",
  "description": "Microsoft Forms can be used for phishing attacks by asking personal or sensitive information and collecting the results. Microsoft 365 has built-in protection that will proactively scan for phishing attempt in forms such personal information request.",
  "rationale": "Enabling internal phishing protection for Microsoft Forms will prevent attackers using forms for phishing attacks by asking personal or other sensitive information and URLs.",
  "impact": "If potential phishing was detected, the form will be temporarily blocked and cannot be distributed, and response collection will not happen until it is unblocked by the administrator or keywords were removed by the creator.",
  "remediation": {
    "text": "To remediate using the UI:\n1. Navigate to Microsoft 365 admin center https://admin.microsoft.com.\n2. Click to expand Settings then select Org settings.\n3. Under Services select Microsoft Forms.\n4. Click the checkbox labeled Add internal phishing protection under Phishing protection.\n5. Click Save.\n\nTo remediate using PowerShell\n1. Connect to the Microsoft Graph service using Connect-MgGraph -Scopes \"OrgSettings-AppsAndServices.ReadWrite.All\".\n2. Run the following Microsoft Graph PowerShell commands:\n   $uri = 'https://graph.microsoft.com/beta/admin/forms/settings'\n   $body = @{ \"isInOrgFormsPhishingScanEnabled\" = $true } | ConvertTo-Json\n   Invoke-MgGraphRequest -Method PATCH -Uri $uri -Body $body",
    "code": {
      "powerShell": null,
      "iac": null,
      "terraform": null,
      "other": null
    }
  },
  "recommendation": null,
  "references": [
    "https://learn.microsoft.com/en-US/microsoft-forms/administrator-settingsmicrosoft-forms",
    "https://learn.microsoft.com/en-US/microsoft-forms/review-unblock-forms-usersdetected-blocked-potential-phishing"
  ],
  "compliance": [
    {
      "name": "CIS Microsoft 365 Foundations",
      "version": "5.0.0",
      "reference": "1.3.5"
    }
  ],
  "level": "medium",
  "tags": [
    "CIS Microsoft 365 Foundations 5.0.0 1.3.5",
    "Microsoft Forms"
  ],
  "rule": {
    "path": "Get-MonkeyFormsTenantInformation",
    "subPath": null,
    "selectCondition": "[?EnablePhishingProtectionForForms -ne 'True']",
    "query": [],
    "shouldExist": null,
    "returnObject": null,
    "removeIfNotExists": null
  },
  "output": {
    "html": {
      "data": {
        "properties": {
          "EnablePhishingProtectionForForms": "Internal Phishing Protection Enabled"
        },
        "expandObject": null
      },
      "table": "Normal",
      "decorate": [
        {
          "ItemName": "Internal Phishing Protection Enabled",
          "ItemValue": "False",
          "className": "badge bg-danger larger-badge"
        }
      ],
      "emphasis": [],
      "actions": {
        "objectData": {
          "properties": ["*"],
          "expandObject": null,
          "limit": null
        },
        "showGoToButton": "False",
        "showModalButton": "True",
        "directLink": null
      }
    },
    "text": {
      "data": {
        "properties": {},
        "expandObject": null
      },
      "status": {
        "keyName": [],
        "message": "Internal phishing protection for Microsoft Forms is not enabled.",
        "defaultMessage": null
      },
      "properties": {
        "resourceName": "FormsSettings",
        "resourceId": "TenantSettings",
        "resourceType": "Microsoft.Forms.TenantSettings"
      },
      "onlyStatus": true
    }
  },
  "idSuffix": "forms-internal-phishing-protection-disabled",
  "notes": [],
  "categories": []
}