{
  "args": [],
  "provider": "Microsoft365",
  "serviceType": "Microsoft Purview",
  "serviceName": "Microsoft 365",
  "displayName": "Ensure DLP policies are enabled",
  "description": "Data Loss Prevention (DLP) policies allow Exchange Online and SharePoint Online content to be scanned for specific types of data like social security numbers, credit card numbers, or passwords.",
  "rationale": "Enabling DLP policies alerts users and administrators that specific types of data should not be exposed, helping to protect the data from accidental exposure.",
  "impact": "Enabling a Teams DLP policy will allow sensitive data in Exchange Online and SharePoint Online to be detected or blocked. Always ensure to follow appropriate procedures during testing and implementation of DLP policies based on organizational standards.",
  "remediation": {
    "text": "To remediate using the UI:\n1. Navigate to Microsoft Purview https://purview.microsoft.com/\n2. Click Solutions > Data loss prevention then Policies.\n3. Click Create policy.\n4. Create a policy that is specific to the types of data the organization wishes to protect.",
    "code": {
      "powerShell": null,
      "iac": null,
      "terraform": null,
      "other": null
    }
  },
  "recommendation": null,
  "references": [
    "https://learn.microsoft.com/en-us/purview/dlp-learn-about-dlp?view=o365worldwide"
  ],
  "compliance": [
    {
      "name": "CIS Microsoft 365 Foundations",
      "version": "5.0.0",
      "reference": "7.2.1" 
    }
  ],
  "level": "medium",
  "tags": [
    "CIS Microsoft 365 Foundations 5.0.0 7.2.1",
    "Microsoft Purview",
    "DLP"
  ],
  "rule": {
    "path": "Get-MonkeyEXODLPCompliancePolicy",
    "subPath": null,
    "selectCondition": "[?mode == 'disable']",
    "query": [],
    "shouldExist": null,
    "returnObject": null,
    "removeIfNotExists": null
  },
  "output": {
    "html": {
      "data": {
        "properties": {
          "name": "Policy Name",
          "mode": "Mode"
        },
        "expandObject": null
      },
      "table": "Normal",
      "decorate": [
        {
          "ItemName": "Mode",
          "ItemValue": "disable",
          "className": "badge bg-danger larger-badge"
        }
      ],
      "emphasis": [],
      "actions": {
        "objectData": {
          "properties": ["*"],
          "expandObject": null,
          "limit": null
        },
        "showGoToButton": "True",
        "showModalButton": "True",
        "directLink": null
      }
    },
    "text": {
      "data": {
        "properties": {},
        "expandObject": null
      },
      "status": {
        "keyName": [],
        "message": "One or more DLP Compliance Policies are disabled.",
        "defaultMessage": null
      },
      "properties": {
        "resourceName": "name",
        "resourceId": "guid",
        "resourceType": "Microsoft.Office.CompliancePolicy.Tasks.DlpCompliancePolicy"
      },
      "onlyStatus": false
    }
  },
  "idSuffix": "purview-dlp-policies-disabled",
  "notes": ["This control is similar to 3.2.1."],
  "categories": []
}